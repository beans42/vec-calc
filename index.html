<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
		<title>Vector Calculator</title>
		<link href="https://cdn.jsdelivr.net/npm/bootswatch@5.0.2/dist/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

		<style>
			input::-webkit-inner-spin-button,input::-webkit-outer-spin-button {
				-webkit-appearance: none;
				margin: 0
			}

			input[type=number] {
				-moz-appearance: textfield
			}

			.clockface {
				all: unset;
				width: 100%;
				padding-top: 100%;
				transform: translateY(0);
				border-style: solid;
				border-radius: 50%
			}

			#big,#small {
				position: absolute;
				top: 50%;
				width: 50%;
				transform-origin: 100%;
				height: 6px
			}

			#big {
				background-color: #000
			}
		</style>
	</head>

	<body>
		<nav class="navbar">
			<div class="container-fluid">
				<span class="navbar-brand mb-0 h1">Vector Calculator</span>
			</div>
		</nav>

		<div class="container">
			<div>
				<label>First Vector</label>
				<div class="row">
					<div class="col-sm-6">
						<input type="number" inputmode="decimal" class="form-control" id="vec_one_mag" oninput="handle()" placeholder="Magnitude" aria-label="Magnitude">
					</div>
					<div class="col-sm-6">
						<input type="number" inputmode="decimal" class="form-control" id="vec_one_dir" oninput="handle()" placeholder="Direction (degrees)" aria-label="Direction (degrees)">
					</div>
				</div>
			</div>
			<div>
				<label>Second Vector</label>
				<div class="row">
					<div class="col-sm-6">
						<input type="number" inputmode="decimal" class="form-control" id="vec_two_mag" oninput="handle()" placeholder="Magnitude" aria-label="Magnitude">
					</div>
					<div class="col-sm-6">
						<input type="number" inputmode="decimal" class="form-control" id="vec_two_dir" oninput="handle()" placeholder="Direction (degrees)" aria-label="Direction (degrees)">
					</div>
				</div>
			</div>
			<div hidden id="result_div">
				<label>Result Vector</label>
				<div class="row">
					<div class="col">
						<input type="text" readonly class="form-control" id="vec_res_mag">
					</div>
					<div class="col">
						<input type="text" readonly class="form-control" id="vec_res_dir">
					</div>
				</div>
				<label>Diagram</label>
				<div class="row">
					<div class="clockface">
						<div id="big"></div>
						<div id="small"></div>
					</div>
				</div>
			</div>
		</div>

		<script>
			const holder_div = document.getElementById("result_div");
			const elems = [
				document.getElementById("vec_one_mag"),
				document.getElementById("vec_one_dir"),
				document.getElementById("vec_two_mag"),
				document.getElementById("vec_two_dir"),
				document.getElementById("vec_res_mag"),
				document.getElementById("vec_res_dir"),
				document.getElementById("big"),
				document.getElementById("small")
			];
			
			function handle() {
				for (let i = 0; i < 4; ++i) {
					if (Number.isNaN(+elems[i].value) || elems[i].value === "") {
						holder_div.hidden = true;
						return;
					}
				}
				const a_vec = [ +elems[0].value, +elems[1].value ];
				const b_vec = [ +elems[2].value, +elems[3].value ];
				const res_vec = vec_add(a_vec, b_vec);
				elems[4].value = res_vec[0];
				elems[5].value = res_vec[1] + "Â°";
				
				let vec_arr = [ a_vec, b_vec ];
				vec_arr.sort((a, b) => {
					return b[0] - a[0];
				});
				
				elems[6].style.transform = "rotate("+(vec_arr[0][1]+90)+"deg)";
				elems[7].style.transform = "rotate("+(vec_arr[1][1]+90)+"deg)";
				const mag_proportion = 100 - +(vec_arr[1][0] / vec_arr[0][0] * 100).toFixed(1);
				elems[7].style.background = "linear-gradient(to right,rgba(255,0,0,0) 0,rgba(255,0,0,0) "+mag_proportion+"%,#000 "+mag_proportion+"%,#000 100%)";
				holder_div.hidden = false;
			}
			
			function vec_add(a_vec, b_vec) { //vec format: [ 60 /*magnitude*/, 45 /*angle, degrees, 0-360*/ ]
				const d2r = x => x * Math.PI / 180;
				const r2d = x => x * 180 / Math.PI;
				const cos = x => Math.cos(d2r(x));
				const sin = x => Math.sin(d2r(x));
				
				const a_cart = [
					a_vec[0] * cos(a_vec[1]),
					a_vec[0] * sin(a_vec[1])
				];
				
				const b_cart = [
					b_vec[0] * cos(b_vec[1]),
					b_vec[0] * sin(b_vec[1])
				];
				
				const sum_cart = [
					a_cart[0] + b_cart[0],
					a_cart[1] + b_cart[1]
				];
				
				const sum_vec = [
					Math.sqrt((sum_cart[0] * sum_cart[0]) + (sum_cart[1] * sum_cart[1])), //magnitude
					r2d(Math.atan2(sum_cart[1], sum_cart[0]))
				];
				
				if (sum_vec[1] < 0)
					sum_vec[1] += 360
				
				return [ +sum_vec[0].toFixed(2), +sum_vec[1].toFixed(2) ];
			}
		</script>
	</body>
</html>